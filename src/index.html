<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link rel="shortcut icon" href="img/favicon.ico">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css"> -->
    <link rel="stylesheet" href="css/mystyle.css">
    <style>
        html {
            overflow: hidden;
        }

        .max-vh {
            min-height: calc(100vh - 59px - 1.5rem);
        }

        .footer-vh {
            height: 70px;
            background-color: grey;
            color: white;
        }
    </style>

    <!--load all styles -->
    <script defer src="js/fontawesome/js/all.js"></script>
</head>

<body>
    <div class="max-vh">
        <section class="mt-5 mb-4 ml-6 mr-6">
            <div class="container">
                <div class="columns is-mobile">
                    <div class="column is-12">
                        <div class="control">
                            <h1 id="ProductName" class="title is-4">Screen Sort</h1>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="ml-6 mr-6">
            <div class="container">
                <div class="columns is-mobile">
                    <div class="column is-9">
                        <div class="field">
                            <p class="control has-icons-left">
                                <input id="ZipFileLocation" class="input is-small" type="text"
                                    placeholder="Select Zip File" readonly>
                                <span class="icon is-small is-left">
                                    <i class="fas fa-file-archive"></i>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="column"><a id="SelectZip" class="button is-fullwidth is-light is-small">Browse</a></div>
                </div>
                <div class="columns is-mobile">
                    <div class="column is-9">
                        <div class="field">
                            <p class="control has-icons-left">
                                <input id="UnZipFileLocation" class="input is-small" type="text"
                                    placeholder="Select Output Destination" readonly>
                                <span class="icon is-small is-left">
                                    <i class="fas fa-folder"></i>
                                </span>
                            </p>
                        </div>
                    </div>
                    <div class="column">
                        <a id="SelectUnZip" class="button is-fullwidth is-light is-small">Set</a>
                    </div>
                </div>
                <div class="columns is-mobile">
                    <div class="column is-9">
                        <a id="ExtractZip" class="button is-fullwidth is-dark is-small">Extract</a></div>
                    <div class="column"></div>

                </div>
            </div>
        </section>
    </div>
    <footer class="footer footer-vh">
        <div class="columns is-mobile ml-5 mr-5">
            <div class="column is-12">
                <p id="Messages" class="is-size-7"></p>
            </div>
        </div>
    </footer>
    <script>
        const { ipcRenderer } = require('electron')
        var path = require('path');

        const BrowseZipBtn = document.getElementById('SelectZip');
        const ExtractZipBtn = document.getElementById('ExtractZip');
        const BrowseUnZipBtn = document.getElementById('SelectUnZip');
        const ShowFolderBtn = document.getElementById('UnZipFileLocation');

        BrowseZipBtn.addEventListener('click', function () {
            console.log("Browse Button Clicked")
            ipcRenderer.send('open-dialog')
        });

        ipcRenderer.on('file-selected', (event, arg) => {
            let filename = path.basename(arg)
            document.getElementById('ZipFileLocation').value = filename
            console.log(filename + " - " + arg)
        });

        ExtractZipBtn.addEventListener('click', () => {
            console.log("Extract Button Clicked")
            ipcRenderer.send('extract-zip')
        });

        ipcRenderer.on('file-extracted', (event, arg) => {
            document.getElementById('Messages').innerHTML = arg;
        });

        BrowseUnZipBtn.addEventListener('click', () => {
            console.log("Browse Button Clicked")
            ipcRenderer.send('open-dest-dialog')
        });

        ipcRenderer.on('folder-selected', (event, arg) => {
            document.getElementById('UnZipFileLocation').value = arg
            console.log(filename + " - " + arg)
        });

        ShowFolderBtn.addEventListener('click', () => {
            console.log("Show Folder Button Clicked")
            ipcRenderer.send('show-folder')
        });
    </script>
</body>

</html>